---
# Global options.
global:

  # Global hyperfine option defaults.
  # Will be overwritten by local options.
  hyperfine:
    warmup: 1
    runs: 5
    export_json: results.json
    shell: /bin/bash
    show_output: true

  # A command to wrap the hyperfine command.
  wrapper: "taskset -c 1-14"

  # Path to source code (required).
  # Can point to a local or online fork of bitcoin/bitcoin.
  source: $HOME/src/core/bitcoin

  # Which branch of the source to check out (required).
  branch: benchmark-test

  # Commits to build binaries from (required).
  # A list of one or more all found in <branch>
  commits: ["62bd1960fdf", "e932c6168b5"]

# Local benchmark config.
benchmarks:

  # benchmark name (required).
  - name: "Check bitcoind version"

    # Local hyperfine options.
    # These override global hyperfine options in case of conflict.
    # Uses regular hyperfine syntax.
    hyperfine:

      # {dbcache} will come from <parameter_lists> and be parameterised.
      command: "bitcoind -dbcache={dbcache} --version"

      # TODO: Remove these and handle in benchkit.
      # setup: "./scripts/example-setup.sh"
      # prepare: "./scripts/example-prepare.sh"
      # conclude: "./scripts/example-conclude.sh"
      # cleanup: "./scripts/example-cleanup.sh"

      warmup: 5
      runs: 10

      # A list of zero or more parameters.
      # These will be tried as a matrix.
      parameter_lists:
        # The variable name to use in hyperfine command substitution.
        - var: dbcache
          # A list of values to substitute in.
          values: ["450", "32000"]

